cmake_minimum_required(VERSION 3.18)
project(chesscore LANGUAGES CXX)
set(CMAKE_CXX_STANDARD 23)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)
set(CMAKE_INTERPROCEDURAL_OPTIMIZATION ON)
find_package(pybind11 CONFIG REQUIRED)
pybind11_add_module(chesscore chess.cpp mcts.cpp encoder.cpp bindings.cpp)
set_target_properties(chesscore PROPERTIES CXX_VISIBILITY_PRESET hidden VISIBILITY_INLINES_HIDDEN YES LIBRARY_OUTPUT_DIRECTORY ${CMAKE_SOURCE_DIR})
target_compile_options(chesscore PRIVATE -O3 -march=native -Wall -Wextra -Wpedantic -ffunction-sections -fdata-sections -fno-plt)
target_link_options(chesscore PRIVATE -Wl,-O2,--gc-sections,--as-needed)
