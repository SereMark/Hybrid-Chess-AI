SEED = 1337

AMP_ENABLED = True
TF32_ENABLE = True
TORCH_COMPILE = True
TORCH_COMPILE_MODE = "reduce-overhead"
TORCH_COMPILE_FULLGRAPH = True
TORCH_COMPILE_DYNAMIC = False
CUDNN_BENCHMARK = True
TORCH_THREADS_INTRA = 1
TORCH_THREADS_INTER = 1
CHANNELS_LAST = True
EVAL_CHANNELS_LAST = True

BOARD_SIZE = 8
NSQUARES = BOARD_SIZE * BOARD_SIZE
PLANES_PER_POSITION = 14
HISTORY_LENGTH = 8
INPUT_PLANES = HISTORY_LENGTH * PLANES_PER_POSITION + 7
POLICY_PLANES = 73
POLICY_OUTPUT = POLICY_PLANES * NSQUARES

NUM_DIRECTIONS = 8
DIR_MAX_DIST = 7
NUM_KNIGHT_DIRS = 8
KNIGHT_PLANES_BASE = 56
PROMO_CHOICES = 3
PROMO_STRIDE = 3
DIR_MAP_MIRROR = [2, 1, 0, 4, 3, 7, 6, 5]
KMAP_MIRROR = [1, 0, 3, 2, 5, 4, 7, 6]
DIR_MAP_ROT180 = [7, 6, 5, 4, 3, 2, 1, 0]
KMAP_ROT180 = [7, 6, 5, 4, 3, 2, 1, 0]
DIR_MAP_VFLIP_CS = [5, 6, 7, 3, 4, 0, 1, 2]
KMAP_VFLIP_CS = [6, 7, 4, 5, 2, 3, 0, 1]
PMAP_PROMOS = [0, 2, 1]
U8_SCALE = 255.0
VALUE_I8_SCALE = 127.0

BLOCKS = 10
CHANNELS = 192
VALUE_CONV_CHANNELS = 8
VALUE_HIDDEN_DIM = 512

EVAL_MAX_BATCH = 2048
EVAL_BATCH_TIMEOUT_MS = 2
EVAL_CACHE_SIZE = 20_000
EVAL_CLOSE_JOIN_TIMEOUT_S = 1.0

BUFFER_SIZE = 200_000
SELFPLAY_WORKERS = 8
MAX_GAME_MOVES = 512
TEMP_MOVES = 20
TEMP_HIGH = 1.0
TEMP_LOW = 0.01
TEMP_DETERMINISTIC_THRESHOLD = 0.01
SIMULATIONS_TRAIN = 512
MCTS_MIN_SIMS = 160
SIMULATIONS_DECAY_INTERVAL = 75
C_PUCT = 1.25
C_PUCT_BASE = 19652.0
C_PUCT_INIT = 1.25
DIRICHLET_ALPHA = 0.3
DIRICHLET_WEIGHT = 0.25
FPU_REDUCTION = 0.10
RESIGN_THRESHOLD = -0.9
RESIGN_CONSECUTIVE = 0
RESIGN_CONSECUTIVE_MIN = 2
RESIGN_PLAYTHROUGH_FRAC = 0.15
OPENING_RANDOM_PLIES_MAX = 7
VISIT_COUNT_CLAMP = 65535
SNAPSHOT_RECENT_WINDOW_FRAC = 0.2
SNAPSHOT_RECENT_RATIO_DEFAULT = 0.6
TRAIN_RECENT_RATIO = 0.8
AUGMENT_MIRROR_PROB = 0.5
AUGMENT_ROT180_PROB = 0.25
AUGMENT_VFLIP_CS_PROB = 0.25

BATCH_SIZE = 3072
LR_INIT = 1.0e-2
LR_WARMUP_STEPS = 3_000
LR_FINAL = 3.0e-4
WEIGHT_DECAY = 1e-4
MOMENTUM = 0.9
GRAD_CLIP = 1.0
POLICY_WEIGHT = 1.0
VALUE_WEIGHT = 0.5
VALUE_WEIGHT_LATE = 1.0
VALUE_WEIGHT_SWITCH_ITER = 60
POLICY_LABEL_SMOOTH = 0.05
ENTROPY_COEF_INIT = 5.0e-4
ENTROPY_ANNEAL_ITERS = 60
EMA_ENABLED = True
EMA_DECAY = 0.9995

ITERATIONS = 600
GAMES_PER_ITER = 220
LR_SCHED_STEPS_PER_ITER_EST = 32
LR_SCHED_DRIFT_ADJUST_THRESHOLD = 20.0
RATIO_TARGET_TRAIN_PER_NEW = 6.0
RATIO_UPDATE_STEPS_MIN = 24
RATIO_UPDATE_STEPS_MAX = 320
CHECKPOINT_EVERY = 50

SIMULATIONS_EVAL = 160
ARENA_EVAL_EVERY = 10
ARENA_EVAL_CACHE_CAP = 8192
ARENA_GAMES = 400
ARENA_TEMPERATURE = 0.75
ARENA_TEMP_MOVES = 8
ARENA_DIRICHLET_WEIGHT = 0.10
ARENA_OPENING_TEMPERATURE_EPS = 1e-6
ARENA_DETERMINISTIC = True
ARENA_STRATIFY_OPENINGS = True
ARENA_DRAW_SCORE = 0.5
ARENA_GATE_DRAW_WEIGHT = ARENA_DRAW_SCORE
ARENA_GATE_BASELINE_P = 0.5
ARENA_GATE_Z_EARLY = 1.28
ARENA_GATE_Z_LATE = 1.96
ARENA_GATE_Z_SWITCH_ITER = 200
ARENA_GATE_MIN_GAMES = 300
ARENA_GATE_DECISIVE_SECONDARY = True
ARENA_GATE_MIN_DECISIVES = 80
ARENA_CANDIDATE_MAX_ROUNDS = 6
ARENA_CANDIDATE_MAX_GAMES = 2400
ARENA_PAIRING_FACTOR = 2
GATE_EPS = 1e-9

OPENINGS_FILE = "openings.txt"
OUTPUT_DIR = "out"
