SEED = 1337

AMP_ENABLED = True
AMP_PREFER_BFLOAT16 = True
TORCH_ALLOW_TF32 = True
TORCH_COMPILE = True
TORCH_COMPILE_MODE = "max-autotune"
TORCH_COMPILE_FULLGRAPH = True
TORCH_COMPILE_DYNAMIC = False
TORCH_CUDNN_BENCHMARK = True
TORCH_THREADS_INTRA = 1
TORCH_THREADS_INTER = 1
TORCH_MATMUL_FLOAT32_PRECISION = "high"
MODEL_CHANNELS_LAST = True
EVAL_MODEL_CHANNELS_LAST = True
TRAIN_PIN_MEMORY = True
EVAL_PIN_MEMORY = True

LOG_TO_FILE = True
LOG_FILE_PATH = "log.txt"
LOG_LEVEL = "INFO"
CUDA_EMPTY_CACHE_EVERY_ITERS = 30
OPENINGS_FILE_PATH = "openings.txt"
CHECKPOINT_SAVE_EVERY_ITERS = 20
CHECKPOINT_FILE_PATH = "checkpoint.pt"
BEST_MODEL_FILE_PATH = "best_model.pt"

BOARD_SIZE = 8
NSQUARES = BOARD_SIZE * BOARD_SIZE
PLANES_PER_POSITION = 14
HISTORY_LENGTH = 8
INPUT_PLANES = HISTORY_LENGTH * PLANES_PER_POSITION + 7
POLICY_PLANES = 73
POLICY_OUTPUT = POLICY_PLANES * NSQUARES
NUM_DIRECTIONS = 8
DIR_MAX_DIST = 7
NUM_KNIGHT_DIRS = 8
KNIGHT_PLANES_BASE = 56
PROMO_CHOICES = 3
PROMO_STRIDE = 3
DIR_MAP_MIRROR = [2, 1, 0, 4, 3, 7, 6, 5]
KMAP_MIRROR = [1, 0, 3, 2, 5, 4, 7, 6]
DIR_MAP_ROT180 = [7, 6, 5, 4, 3, 2, 1, 0]
KMAP_ROT180 = [7, 6, 5, 4, 3, 2, 1, 0]
DIR_MAP_VFLIP_CS = [5, 6, 7, 3, 4, 0, 1, 2]
KMAP_VFLIP_CS = [6, 7, 4, 5, 2, 3, 0, 1]
PMAP_PROMOS = [0, 2, 1]
U8_SCALE = 255.0
VALUE_I8_SCALE = 127.0

MODEL_BLOCKS = 16
MODEL_CHANNELS = 256
MODEL_VALUE_CONV_CHANNELS = 16
MODEL_VALUE_HIDDEN_DIM = 1024

EVAL_BATCH_SIZE_MAX = 8192
EVAL_BATCH_COALESCE_MS = 5
EVAL_CACHE_CAPACITY = 120_000
EVAL_WORKER_JOIN_TIMEOUT_S = 0.25
EVAL_CACHE_USE_FP16 = True

REPLAY_BUFFER_CAPACITY = 120_000
SELFPLAY_NUM_WORKERS = 12
GAME_MAX_PLIES = 512
SELFPLAY_TEMP_MOVES = 50
SELFPLAY_TEMP_HIGH = 0.90
SELFPLAY_TEMP_LOW = 0.05
SELFPLAY_DETERMINISTIC_TEMP_EPS = 0.01
SELFPLAY_OPENING_RANDOM_PLIES_MAX = 8

MCTS_TRAIN_SIMULATIONS_BASE = 1024
MCTS_TRAIN_SIMULATIONS_MIN = 256
MCTS_TRAIN_SIM_DECAY_MOVE_INTERVAL = 24
MCTS_C_PUCT = 1.30
MCTS_C_PUCT_BASE = 19652.0
MCTS_C_PUCT_INIT = 1.50
MCTS_DIRICHLET_ALPHA = 0.35
MCTS_DIRICHLET_WEIGHT = 0.30
MCTS_FPU_REDUCTION = 0.10
MCTS_VISIT_COUNT_CLAMP = 65535

RESIGN_VALUE_THRESHOLD = -0.95
RESIGN_CONSECUTIVE_PLIES = 4
RESIGN_CONSECUTIVE_MIN = 3
RESIGN_PLAYTHROUGH_FRACTION = 0.25

REPLAY_SNAPSHOT_RECENT_WINDOW_FRAC = 0.2
REPLAY_SNAPSHOT_RECENT_RATIO_DEFAULT = 0.6
TRAIN_RECENT_SAMPLE_RATIO = 0.70
AUGMENT_MIRROR_PROB = 0.5
AUGMENT_ROT180_PROB = 0.25
AUGMENT_VFLIP_CS_PROB = 0.25

TRAIN_BATCH_SIZE = 4096
TRAIN_LR_INIT = 2.7e-3
TRAIN_LR_WARMUP_STEPS = 4_000
TRAIN_LR_FINAL = 5.0e-4
TRAIN_WEIGHT_DECAY = 1e-4
TRAIN_MOMENTUM = 0.9
TRAIN_GRAD_CLIP_NORM = 0.75
LOSS_POLICY_WEIGHT = 1.0
LOSS_VALUE_WEIGHT = 0.8
LOSS_VALUE_WEIGHT_LATE = 1.0
LOSS_VALUE_WEIGHT_SWITCH_ITER = 30
LOSS_POLICY_LABEL_SMOOTH = 0.03
LOSS_ENTROPY_COEF_INIT = 1.0e-4
LOSS_ENTROPY_ANNEAL_ITERS = 60
LOSS_ENTROPY_COEF_MIN = 4.0e-05
EMA_ENABLED = True
EMA_DECAY = 0.999

TRAIN_TOTAL_ITERATIONS = 600
SELFPLAY_GAMES_PER_ITER = 600
TRAIN_LR_SCHED_STEPS_PER_ITER_EST = 60
TRAIN_LR_SCHED_DRIFT_ADJUST_THRESHOLD = 15.0
TRAIN_TARGET_TRAIN_SAMPLES_PER_NEW = 5.0
TRAIN_UPDATE_STEPS_MIN = 24
TRAIN_UPDATE_STEPS_MAX = 640

MCTS_EVAL_SIMULATIONS = 800
ARENA_EVAL_EVERY_ITERS = 10
ARENA_EVAL_CACHE_CAPACITY = 32_768
ARENA_GAMES_PER_EVAL = 400
ARENA_TEMPERATURE = 0.0
ARENA_TEMP_MOVES = 0
ARENA_DIRICHLET_WEIGHT = 0.0
ARENA_OPENING_TEMPERATURE_EPS = 1e-6
ARENA_DETERMINISTIC = True
ARENA_STRATIFY_OPENINGS = True
ARENA_DRAW_SCORE = 0.5
ARENA_GATE_DRAW_WEIGHT = ARENA_DRAW_SCORE
ARENA_GATE_BASELINE_P = 0.5
ARENA_GATE_Z_EARLY = 1.64
ARENA_GATE_Z_LATE = 2.05
ARENA_GATE_Z_SWITCH_ITER = 200
ARENA_GATE_MIN_GAMES = 400
ARENA_GATE_DECISIVE_SECONDARY = True
ARENA_GATE_MIN_DECISIVES = 120
ARENA_CANDIDATE_MAX_ROUNDS = 6
ARENA_CANDIDATE_MAX_GAMES = 2400
ARENA_PAIRING_FACTOR = 3
ARENA_GATE_EPS = 1e-9
